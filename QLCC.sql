create database QLCC
go
use QLCC
go

-- use master
-- DROP DATABASE QLCC
-- SET datefomat DMY;
create table NHANVIEN (
    MaNhanVien  CHAR(4) PRIMARY KEY,
    TenNhanVien NVARCHAR(100),
    SoDienThoai VARCHAR(11),
    GioiTinh    bit,
)

create TABLE CANHO (
    MaCanHo CHAR(4) PRIMARY KEY,
    TenChuHo    NVARCHAR(100)
)

create TABLE THIETBI (
    MaThietBi CHAR(4) PRIMARY KEY,
    TenThietBi  NVARCHAR(100)
)

CREATE TABLE NV_BT (
    MaNhanVien  CHAR(4),
    MaThietBi   CHAR(4),
    MaCanHo     CHAR(4),
    LanThu      INT,
    NgayBaoTri  smalldatetime,
    CONSTRAINT pk_nv_bt PRIMARY KEY (MaNhanVien, MaThietBi, MaCanHo, LanThu)
)

ALTER TABLE NV_BT 
add CONSTRAINT fk_bt_nv FOREIGN KEY (MaNhanVien) REFERENCES NHANVIEN(MaNhanVien);
ALTER TABLE NV_BT 
add CONSTRAINT fk_bt_ch FOREIGN KEY (MaCanHo) REFERENCES CANHO(MaCanHo);
ALTER TABLE NV_BT 
add CONSTRAINT fk_bt_tb FOREIGN KEY (MaThietBi) REFERENCES THIETBI(MaThietBi);

INSERT INTO NHANVIEN VALUES ('NV01','NGUYEN VAN A',null,1);
INSERT INTO NHANVIEN VALUES ('NV02','NGUYEN VAN B',null,1);
INSERT INTO NHANVIEN VALUES ('NV03','NGUYEN THI C',null,0);

INSERT INTO CANHO VALUES ('CH01',N'Nguyễn Ngọc Khương Duy');


INSERT INTO THIETBI VALUES ('TB01','TIVI');
INSERT INTO THIETBI VALUES ('TB02','Dien Thoai');

SELECT * FROM CANHO;
DELETE FROM CANHO;

INSERT INTO NV_BT VALUES ('NV01','TB01','CH01',1,'11/19/2021');
INSERT INTO NV_BT VALUES ('NV01','TB01','CH01',2,'11/19/2021');
INSERT INTO NV_BT VALUES ('NV01','TB01','CH01',3,'11/19/2021');
INSERT INTO NV_BT VALUES ('NV02','TB02','CH01',1,'11/19/2021');
INSERT INTO NV_BT VALUES ('NV02','TB02','CH01',2,'11/19/2021');